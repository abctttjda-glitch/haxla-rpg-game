<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Job Master Tower v4.7.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<style>
:root { --bg: #050505; --panel: #111; --accent: #d4af37; --text: #ccc; --border: #333; }
* { touch-action: manipulation; box-sizing: border-box; -webkit-user-select: none; }
body { margin:0; background:var(--bg); color:var(--text); font-family: 'Consolas', monospace; height: 100dvh; display:flex; flex-direction:column; padding:8px; overflow:hidden; }
button { background:#222; color:#eee; border:1px solid #444; border-radius:4px; cursor:pointer; padding:8px; font-size:11px; }
button:active { background: #444; }
.active-toggle { background: #b38f00 !important; color: #000 !important; font-weight: bold; }
.auto-on { background: #006400 !important; border-color: #0f0 !important; }

/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ‘ãƒãƒ« */
.hero-status-panel { background:var(--panel); border:1px solid var(--accent); padding:10px; border-radius:4px; margin-bottom:6px; display:grid; grid-template-columns: 1fr 1.5fr; gap:10px; position: relative; }
.exp-bar { width: 100%; background: #222; height: 5px; margin-top: 4px; overflow: hidden; }
.exp-fill { background: #3498db; height: 100%; width: 0%; transition: width 0.3s; }

.enemy-box { text-align: center; padding: 10px; border: 1px solid var(--border); background: #000; margin-bottom: 6px; }
.hp-bar { width: 100%; background:#200; height:12px; border:1px solid #400; margin-top:4px; overflow: hidden; }
.hp-fill { background:linear-gradient(90deg, #900, #f00); height:100%; width:100%; transition: width 0.1s; }

.log-area { flex: 1; background:#000; border:1px solid var(--border); overflow-y:auto; padding:8px; font-size:11px; line-height:1.3; display:flex; flex-direction:column-reverse; margin-bottom:6px; }

.battle-actions { display: flex; gap: 4px; margin-bottom: 8px; }
#btnAttack { flex: 2; height: 45px; background: #400; font-weight: bold; border: 1px solid #822; }

.btn-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 4px; }

.modal { display: none; position: fixed; inset:0; background:rgba(0,0,0,0.98); z-index:100; justify-content:center; align-items:center; }
.modal-content { background:#111; border:1px solid #333; width:95%; height:92%; padding:15px; overflow-y:auto; }
.st-row { background: #1a1a1a; padding: 10px; border-radius: 4px; margin-bottom: 8px; border: 1px solid #333; }
.list-row { border-bottom:1px solid #222; padding:10px 0; display:flex; justify-content:space-between; align-items:center; }
</style>
</head>
<body>

<div class="hero-status-panel">
    <div>
        <small id="jobLabel" style="color:var(--accent); font-weight:bold;">---</small><br>
        <b style="font-size:16px;">Lv.<span id="hLv">1</span></b><br>
        <div style="font-size:9px; color:#888;">
            æ¬¡ã¾ã§: <span id="nextExp">0</span><br>
            <div class="exp-bar"><div id="expFill" class="exp-fill"></div></div>
        </div>
    </div>
    <div style="font-size:11px;">
        HP : <b id="hHp">0/0</b><br>
        æ”»æ’ƒ: <b id="hAtk">0</b> / é˜²å¾¡: <b id="hDef">0</b><br>
        PP : <b id="hPp" style="color:#3498db">0</b> / SP: <b id="hSp" style="color:var(--accent)">0</b>
    </div>
</div>

<div class="enemy-box">
    <div style="display:flex; justify-content:space-between; font-size:12px; margin-bottom:4px;">
        <span onclick="changeFloor(-1)">â—€æˆ»ã‚‹</span>
        <b id="eName">---</b>
        <span onclick="changeFloor(1)">é€²ã‚€â–¶</span>
    </div>
    <div class="hp-bar"><div id="eHpFill" class="hp-fill"></div></div>
    <div id="eHpNum" style="font-size:10px;">0 / 0</div>
</div>

<div class="log-area" id="log"></div>

<div class="battle-actions">
    <button id="btnAttack">æ”»æ’ƒ</button>
    <button id="btnAuto" onclick="toggleAuto()">è‡ªå‹•æˆ¦é—˜: OFF</button>
</div>

<div class="btn-grid">
    <button onclick="openM('statM')">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</button>
    <button onclick="openM('jobM')">ã‚¸ãƒ§ãƒ–</button>
    <button onclick="openM('skillM')">ã‚¹ã‚­ãƒ«</button>
    <button onclick="openM('equipM')">ã‚¢ã‚¤ãƒ†ãƒ </button>
</div>

<div id="statM" class="modal"><div class="modal-content">
    <h3>ğŸ“Š ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¼·åŒ–</h3>
    <p style="font-size:10px; color:var(--accent);">è‡ªå‹•ãƒœã‚¿ãƒ³ã‚’ONã«ã™ã‚‹ã¨Lvã‚¢ãƒƒãƒ—æ™‚ã«å„ªå…ˆçš„ã«æŒ¯ã‚Šã¾ã™</p>
    
    <div class="st-row">
        <div style="display:flex; justify-content:space-between;"><b>æ”»æ’ƒåŠ›</b> <button id="auto_atk" onclick="toggleAutoTarget('atk')">è‡ªå‹•:OFF</button></div>
        <div style="margin-top:5px;"><button onclick="modST('atk',1)">+1</button><button onclick="modST('atk',10)">+10</button><button onclick="modST('atk',100)">+100</button><button onclick="modST('atk',1000)">+1k</button></div>
    </div>
    <div class="st-row">
        <div style="display:flex; justify-content:space-between;"><b>é˜²å¾¡åŠ›</b> <button id="auto_def" onclick="toggleAutoTarget('def')">è‡ªå‹•:OFF</button></div>
        <div style="margin-top:5px;"><button onclick="modST('def',1)">+1</button><button onclick="modST('def',10)">+10</button><button onclick="modST('def',100)">+100</button><button onclick="modST('def',1000)">+1k</button></div>
    </div>
    <div class="st-row">
        <div style="display:flex; justify-content:space-between;"><b>æœ€å¤§HP</b> <button id="auto_hp" onclick="toggleAutoTarget('hp')">è‡ªå‹•:OFF</button></div>
        <div style="margin-top:5px;"><button onclick="modST('hp',1)">+1</button><button onclick="modST('hp',10)">+10</button><button onclick="modST('hp',100)">+100</button><button onclick="modST('hp',1000)">+1k</button></div>
    </div>

    <button onclick="resetPP()" style="color:#e74c3c; width:100%; padding:5px;">PPã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦å…¨å›å</button><br><br>
    <button onclick="closeM('statM')" style="width:100%">é–‰ã˜ã‚‹</button>
</div></div>

<div id="jobM" class="modal"><div class="modal-content"><h3>ğŸ›¡ï¸ ã‚¸ãƒ§ãƒ–ãƒã‚§ãƒ³ã‚¸</h3><div id="jobList"></div><br><button onclick="closeM('jobM')">æˆ»ã‚‹</button></div></div>
<div id="skillM" class="modal"><div class="modal-content"><h3>ğŸ“ <span id="curJobTitle"></span> å›ºæœ‰ã‚¹ã‚­ãƒ«</h3><div id="sList"></div><br><button onclick="closeM('skillM')">æˆ»ã‚‹</button></div></div>
<div id="equipM" class="modal"><div class="modal-content"><h3>ğŸ“¦ ã‚¢ã‚¤ãƒ†ãƒ </h3><div id="iList"></div><br><button onclick="closeM('equipM')">æˆ»ã‚‹</button></div></div>

<script>
const SAVE_KEY = "Slayer_v4.7.0";
let floor=1, maxFloor=1, sp=0, pp=0, autoBattle=false;
let autoTargets = { atk:false, def:false, hp:false };
let st = { hp:20, atk:10, def:10 }; 
let hero = { lv:1, exp:0, job:'warrior', hp:200, eq:{w:null, a:null} };
let inventory = [], skills = {};

// 20ã‚¸ãƒ§ãƒ– Ã— 10ã‚¹ã‚­ãƒ«
const JOB_INFO = {
    warrior: { n:"æˆ¦å£«", s:["ãªãæ‰•ã„","ç›¾å—ã‘","å¥®èµ·","æ¨ã¦èº«","é‹¼ã®è‚‰ä½“","å…œå‰²ã‚Š","é›„å«ã³","é€£æ’ƒ","ä¸å±ˆã®é—˜å¿—","ç©¶æ¥µæ–¬"] },
    mage: { n:"é­”è¡“å¸«", s:["ç«çƒ","é­”åŠ›è²¯ã‚","æ°·çµ","é­”è¡“éšœå£","äºŒé‡è© å”±","é›·é³´","çŸ¥æµã®æ³‰","å¸é­”","æ™‚ç©ºæ­ªæ›²","ç¦å‘ª"] },
    thief: { n:"ç›—è³Š", s:["ç›®æ½°ã—","ç´ æ—©ã„èº«ã®ã“ãªã—","ç›—ã¿ã®æ¥µæ„","å¥‡è¥²","éš ã‚Œèº«","ç½ è¨­ç½®","æ¯’æ‰‹","éµé–‹ã‘","é‡‘é‹","ç¥é€Ÿ"] },
    cleric: { n:"è–è·è€…", s:["å›å¾©","æµ„åŒ–","é˜²è­·ã®ç¥ˆã‚Š","è–ãªã‚‹å…‰","ç¥ç¦","çŒ®èº«","å¥‡è·¡","æ•‘æ¸ˆ","åŠ è­·","å¤©ç½°"] },
    samurai: { n:"ä¾", s:["å±…åˆ","é»™æƒ³","å³°æ‰“ã¡","ç‡•è¿”ã—","å¿ƒçœ¼","è¦‹åˆ‡ã‚Š","é¬¼æ°—","ä¸å‹•å¿ƒ","ä¸€åˆ€ä¸¡æ–­","æ•£ã‚Šéš›"] },
    ninja: { n:"å¿è€…", s:["æ‰‹è£å‰£","èº«ä»£ã‚ã‚Š","å½±åˆ†èº«","ç«é","åœŸé","æ°´é","å¤‰ã‚ã‚Šèº«","æš—æ®º","ç©ºè‰","å¥¥ç¾©ä¼æ‰¿"] },
    monk: { n:"æ‹³é—˜å£«", s:["æ­£æ‹³çªã","æ°—åˆ","é‰„æ‹³","ç·´æ°—","é€£æ‰“","ç„¡å‘¼å¸","å†…åŠŸ","é‡‘å‰›æ‹³","æ³¢å‹•","ç™¾çƒˆæ‹³"] },
    ranger: { n:"ç‹©äºº", s:["ç‹™ã„æ’ƒã¡","ä»•æ›ã‘ç½ ","é·¹ã®ç›®","é€£å°„","ã‚«ãƒ¢ãƒ•ãƒ©ãƒ¼ã‚¸ãƒ¥","é‡ä¼","æ¯’çŸ¢","å¤šé‡çŸ¢","ç£ä½¿ã„","å¿…æ®ºçŸ¢"] },
    knight: { n:"é¨å£«", s:["é¨å£«é“","çªæ’ƒ","é‰„å£","æŒ‘ç™º","åèª‰","é™£å½¢","è–åŸŸ","é‡åœ§","ä¸é€€è»¢","ç‹ã®å®ˆè­·"] },
    berserker: { n:"ç‹‚æˆ¦å£«", s:["ç‹‚ä¹±","å‡ºè¡€","è‚‰æ–¬éª¨æ–­","ç ´å£Š","å¼·å¥ª","åŸ·å¿µ","æ†¤æ€’","æ¿€éœ‡","æ­»åœ°","æœ€çµ‚æ±ºæˆ¦"] },
    dragoon: { n:"ç«œé¨å£«", s:["è·³èº","æ§æŠ•ã’","ç«œã®æ¯å¹","ç«œé±—","é«˜ç©º","æ—‹é¢¨","è²«é€š","å± ç«œ","ç«œé­‚","é£›ç¿”æ–¬"] },
    necromancer: { n:"æ­»éœŠä½¿ã„", s:["è…æ•—","éª¸éª¨å¬å–š","æ­»è€…ã®å‘ªã„","ç”Ÿæ°—å¸å","éª¨ã®å£","éºä½“çˆ†ç ´","äº¡éœŠã®åŠ è­·","å†¥åºœ","è˜‡ç”Ÿ","é­‚ã®é¸åˆ¥"] },
    bard: { n:"åŸéŠè©©äºº", s:["å‹‡æ°—ã®æ­Œ","å®ˆã‚Šã®èª¿ã¹","ç™’ã‚„ã—ã®éŸ³","æƒ‘ã‚ã—ã®æ—‹å¾‹","åéŸ¿","èª¿å¾‹","é®é­‚æ­Œ","å³èˆˆæ›²","è‹±é›„è­š","çµ‚æ›²"] },
    alchemist: { n:"éŒ¬é‡‘è¡“å¸«", s:["æŠ•è–¬","çˆ†ç™º","åˆæˆ","å¤‰æ›","ç¡¬åŒ–è–¬","å¢—å¹…æ¶²","è³¢è€…ã®çŸ³","é»„é‡‘åŒ–","è§¦åª’","å‰µé€ "] },
    assassin: { n:"æš—æ®ºè€…", s:["æ€¥æ‰€çªã","æ¯’ç…™","å‡¦åˆ‘","ä¸æ„æ‰“ã¡","å½±èµ°ã‚Š","ç„¡åŠ›åŒ–","éš å¯†","è‡´å‘½å‚·","é™å¯‚","çµ‚ç„‰"] },
    paladin: { n:"è–é¨å£«", s:["è–åŸŸ","å®ˆè­·","è£ã","çŒ®èº«","è–å‰£","é™è‡¨","å¤©å•“","ç ´é‚ª","ä¸æ»…","æ „å…‰"] },
    sage: { n:"è³¢è€…", s:["è§£æ","è³¢çŸ¥","é­”åŠ›å¾ªç’°","å…¨é­”æ³•","ç‘æƒ³","ç†ã®æ¢æ±‚","ç¦æ›¸","è–åŸŸ","ä¸‡è±¡","çœŸç†"] },
    darkknight: { n:"æš—é»’é¨å£«", s:["é—‡ã®å‰£","ç”Ÿæ°—ç•¥å¥ª","è™šè„±","çµ¶æœ›","å½±ã®è¡£","èƒŒå¾³","å¥ˆè½","å‘ªæ€¨","æ·±æ·µ","æ··æ²Œ"] },
    dancer: { n:"è¸Šã‚Šå­", s:["æƒ…ç†±ã®ã‚¹ãƒ†ãƒƒãƒ—","æ‰‡ã®èˆ","èª˜æƒ‘","è»½æ¥­","æ¿€åŠ±","å‰£èˆ","é­…äº†","é¼“èˆ","ç¥ç¦ã®èˆ","çµ¶é ‚"] },
    summoner: { n:"å¬å–šå¸«", s:["ç²¾éœŠå¬å–š","é­”ç£å‘¼ã³","å¥‘ç´„","å‘½ä»¤","å…±é³´","è»¢é€","ä½¿å½¹","å®ˆè­·ç£","èåˆ","ä¸‡ç£ç‹"] }
};

function updateUI() {
    let sA=0, sD=0, sH=0;
    Object.keys(skills).forEach(j => {
        Object.keys(skills[j]).forEach(sid => {
            const lv = skills[j][sid];
            sA += lv*3; sD += lv*2; sH += lv*50;
        });
    });
    
    let eA = hero.eq.w ? hero.eq.w.atk : 0;
    let eD = hero.eq.a ? hero.eq.a.def : 0;

    const oldMaxHp = hero.maxHp || 1;
    hero.maxHp = (st.hp * 10) + sH;
    
    // HPãƒã‚°ä¿®æ­£ï¼šæœ€å¤§HPã®å¤‰åŒ–ã«åˆã‚ã›ã¦ç¾åœ¨HPã‚’èª¿æ•´
    if(hero.hp === undefined || hero.hp > hero.maxHp) hero.hp = hero.maxHp;

    hero.atk = st.atk + sA + eA;
    hero.def = st.def + sD + eD;
    
    const nextVal = hero.lv * 50;
    document.getElementById("hLv").innerText = hero.lv;
    document.getElementById("hHp").innerText = `${Math.floor(hero.hp)}/${hero.maxHp}`;
    document.getElementById("hAtk").innerText = hero.atk;
    document.getElementById("hDef").innerText = hero.def;
    document.getElementById("hPp").innerText = pp;
    document.getElementById("hSp").innerText = sp;
    document.getElementById("nextExp").innerText = nextVal - hero.exp;
    document.getElementById("expFill").style.width = (hero.exp / nextVal * 100) + "%";
    document.getElementById("jobLabel").innerText = (JOB_INFO[hero.job]||{n:hero.job}).n;
    document.getElementById("mPp").innerText = pp;
    
    // è‡ªå‹•è¨­å®šãƒœã‚¿ãƒ³ã®è¦‹ãŸç›®æ›´æ–°
    ["atk","def","hp"].forEach(type => {
        const btn = document.getElementById("auto_"+type);
        if(btn) {
            btn.className = autoTargets[type] ? "auto-on" : "";
            btn.innerText = autoTargets[type] ? "è‡ªå‹•:ON" : "è‡ªå‹•:OFF";
        }
    });
}

function modST(k, v) {
    let amt = Math.min(v, pp);
    if(amt > 0) { st[k] += amt; pp -= amt; }
    updateUI(); save();
}

function resetPP() {
    pp += (st.hp - 20) + (st.atk - 10) + (st.def - 10);
    st = { hp:20, atk:10, def:10 };
    updateUI(); save();
}

function toggleAutoTarget(type) {
    autoTargets[type] = !autoTargets[type];
    updateUI();
}

function toggleAuto() {
    autoBattle = !autoBattle;
    const btn = document.getElementById("btnAuto");
    btn.className = autoBattle ? "active-toggle" : "";
    btn.innerText = autoBattle ? "è‡ªå‹•æˆ¦é—˜: ON" : "è‡ªå‹•æˆ¦é—˜: OFF";
}

function addLog(msg, col="") {
    const l = document.getElementById("log");
    const d = document.createElement("div"); if(col) d.style.color = col;
    d.innerText = `> ${msg}`; l.prepend(d);
    if(l.childNodes.length > 25) l.removeChild(l.lastChild);
}

function changeFloor(v) {
    let n = floor + v;
    if(n >= 1 && n <= maxFloor) { floor = n; nextBattle(); }
}

let enemy = null;
function nextBattle() {
    const isB = (floor % 50 === 0);
    const m = Math.pow(1.05, floor-1) * (isB ? 4 : 1);
    enemy = {
        name: (isB?"ã€BOSSã€‘":"") + floor + "éšã®é­”ç‰©",
        hp: Math.floor((100 + floor*20) * m),
        atk: Math.floor((8 + floor*1.8) * m),
    };
    enemy.maxHp = enemy.hp;
    document.getElementById("eName").innerText = enemy.name;
    updateE();
}

function updateE() {
    if(!enemy) return;
    document.getElementById("eHpFill").style.width = (enemy.hp/enemy.maxHp*100) + "%";
    document.getElementById("eHpNum").innerText = `${Math.floor(enemy.hp)} / ${enemy.maxHp}`;
}

function pAtk() {
    if(!enemy) return;
    enemy.hp -= Math.max(1, hero.atk - enemy.atk*0.05);
    updateE();
    if(enemy.hp <= 0) {
        const xp = 20 + floor;
        addLog(`${enemy.name}æ’ƒç ´ï¼ ${xp}çµŒé¨“å€¤ç²å¾—`, "#2ecc71");
        hero.exp += xp;
        if(hero.exp >= hero.lv * 50) {
            hero.lv++; hero.exp=0; pp += 5; sp += 1;
            addLog(`ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼ PP+5 SP+1ç²å¾—`, "#3498db");
            // è‡ªå‹•ã‚¹ãƒ†æŒ¯ã‚Šå®Ÿè¡Œ
            let targets = Object.keys(autoTargets).filter(k => autoTargets[k]);
            if(targets.length > 0) {
                let per = Math.floor(pp / targets.length);
                targets.forEach(t => { st[t] += per; pp -= per; });
            }
        }
        if(Math.random() < 0.2 || floor % 50 === 0) drop();
        if(floor === maxFloor) maxFloor++;
        floor++; save(); updateUI(); nextBattle();
    }
}

function drop() {
    const isW = Math.random() > 0.5;
    const l = Math.floor(floor/5) + 1;
    const adjs = ["é‹­ã„", "é‡åšãª", "é‰„å£ã®", "å¤ã³ãŸ", "å…‰ã‚‹", "é­”åŠ›ã®"];
    const adj = adjs[Math.floor(Math.random()*adjs.length)];
    const i = { 
        id:Date.now(), n:`[${adj}] `+(isW?"è‹±é›„ã®å‰£":"å®ˆè­·ã®é§")+`+${l}`, 
        type:isW?'w':'a', atk:isW?l*15:0, def:isW?0:l*12 
    };
    inventory.push(i);
    addLog(`æ‹¾ï¼š${i.n}`, "#d4af37");
}

// æ”»æ’ƒãƒ»ã‚¿ãƒ¼ãƒ³å‡¦ç†
setInterval(() => { if(autoBattle) pAtk(); }, 120);
setInterval(() => { if(enemy) {
    hero.hp -= Math.max(1, enemy.atk - hero.def);
    updateUI();
    if(hero.hp <= 0) { hero.hp=hero.maxHp; floor = Math.max(1, floor-1); nextBattle(); addLog("æ•—åŒ—...1ã¤ä¸‹ã®éšã¸é€€é¿ã€‚","#e74c3c"); }
}}, 1000);

document.getElementById("btnAttack").onclick = pAtk;

function openM(id) {
    document.getElementById(id).style.display = "flex";
    const d = document.getElementById(id==='jobM'?'jobList':id==='skillM'?'sList':'iList');
    if(!d) return; d.innerHTML = "";
    if(id==='jobM') Object.keys(JOB_INFO).forEach(k => {
        d.innerHTML += `<div class="list-row"><b>${JOB_INFO[k].n}</b> <button onclick="changeJob('${k}')" ${hero.job===k?'disabled':''}>é¸æŠ</button></div>`;
    });
    if(id==='skillM') {
        const j = JOB_INFO[hero.job]; document.getElementById("curJobTitle").innerText = j.n;
        j.s.forEach((sn, i) => {
            const sid = hero.job+"_"+i; const lv = (skills[hero.job]||{})[sid]||0;
            d.innerHTML += `<div class="list-row"><div><b>${sn} (Lv.${lv})</b><br><small>å…¨èƒ½åŠ›å¾®å¢—</small></div> <button onclick="buyS('${sid}')">å¼·åŒ–</button></div>`;
        });
    }
    if(id==='equipM') inventory.forEach(i => {
        const isEq = hero.eq.w?.id === i.id || hero.eq.a?.id === i.id;
        d.innerHTML += `<div class="list-row"><div><b>${i.n}</b><br><small>${i.atk?`æ”»æ’ƒ+${i.atk}`:`é˜²å¾¡+${i.def}`}</small></div> <button onclick="eqI(${i.id})" ${isEq?'disabled':''}>è£…å‚™</button></div>`;
    });
}

function changeJob(k) { hero.job = k; updateUI(); save(); openM('jobM'); addLog(`${JOB_INFO[k].n}ã«è»¢è·ï¼`); }
function buyS(id) { if(sp>=1){ sp--; if(!skills[hero.job]) skills[hero.job]={}; skills[hero.job][id]=(skills[hero.job][id]||0)+1; updateUI(); save(); openM('skillM'); } }
function eqI(id) { const i = inventory.find(x=>x.id===id); hero.eq[i.type]=i; updateUI(); save(); openM('equipM'); }
function closeM(id) { document.getElementById(id).style.display = "none"; }
function save() { localStorage.setItem(SAVE_KEY, JSON.stringify({ hero, st, skills, inventory, floor, maxFloor, sp, pp, autoTargets })); }
function load() {
    const s = localStorage.getItem(SAVE_KEY);
    if(s) { const d = JSON.parse(s); hero=d.hero; st=d.st; skills=d.skills; inventory=d.inventory; floor=d.floor; maxFloor=d.maxFloor; sp=d.sp; pp=d.pp; autoTargets=d.autoTargets||autoTargets; }
    hero.hp = hero.maxHp;
}
load(); updateUI(); nextBattle();
</script>
</body>
</html>
